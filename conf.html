<!DOCTYPE html>
<html>
<head>
<title></title>
<link type="text/css" rel="stylesheet" href="css/base.css" />
<link type="text/css" rel="stylesheet" href="css/config.css" />
<script type="text/javascript" src="js/db.js"></script>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">
/*<![CDATA[*/
var Controller = function(){return chrome.extension.getBackgroundPage()};
function Traduz(s, e){
  return Controller().Traduz(s, e);
}
function html(r){
    return document.write(r);
}
function J2S(obj){
    return JSON.stringify(obj);
}
function S2J(str){
    return JSON.parse(str);
}
var config;

function Toggle(el){
  if($(el).attr('active') == "false"){
    $('fieldset').each(function(i,n){
        if($(el)[0] == n){
          $('div', $(el)).slideDown();
          return;
        }
        $($('fieldset div')[i]).slideUp();
    });
  }
}

function getByValue(selectId, value){
    var ops = $('#'+selectId)[0].options;
    for(i=0;i<ops.length;i++){
      if(ops[i].value == value){
        return i;
      }
    }

}

function SelectOption(selectId, value){
    $('#'+selectId)[0].options[getByValue(selectId, value)].selected = 'selected';
}
function GetValue(selectId){
    return $('#'+selectId).val();
}

function Reset(){
    db.deleta('config');
    Controller().language[Controller().language.id]['slogan_bak'] = Controller().language[Controller().language.id]['slogan'];
    Controller().LoadConfig();
    location.reload();
}

function ResetSlogan(){
    config.twitter_question = Controller().language[Controller().language.id]['slogan_bak'];
    $('#twitter_question').val(config.twitter_question);
}

function LoadConfig(){
    if(!db.pega('config')){
        config = Controller().DefaultConfig;
    }else{
        config = S2J(db.pega('config'));
    }

    if(config.twitter_question){
      Controller().language[Controller().language.id]['slogan_bak'] = Controller().language[Controller().language.id]['slogan'];
      Controller().language[Controller().language.id]['slogan'] = config.twitter_question;
    }else{
      config.twitter_question = Controller().language[Controller().language.id].slogan;
    }

    SelectOption('language', config.language);
    SelectOption('url_shortener', config.url_shortener);
    SelectOption('alerts', config.alerts);
    SelectOption('alerts_max', config.alerts_max);
    SelectOption('tweet_font_size', config.tweet_font_size);
    SelectOption('tweet_shadow', config.tweet_shadow);
    SelectOption('link_in_bg', config.link_in_bg);
    SelectOption('home_tweets_page', config.start_count.home);
    SelectOption('home_refresh_time', config.refresh.home);
    SelectOption('mentions_tweets_page', config.start_count.mentions);
    SelectOption('mentions_refresh_time', config.refresh.mentions);
    SelectOption('messages_tweets_page', config.start_count.messages);
    SelectOption('messages_refresh_time', config.refresh.messages);

    $('#twitter_question').val(config.twitter_question);
}

function SaveConfig(){
    config.language             = GetValue('language');
    config.url_shortener        = GetValue('url_shortener');
    config.alerts               = GetValue('alerts');
    config.alerts_max           = GetValue('alerts_max');
    config.tweet_font_size      = GetValue('tweet_font_size');
    config.tweet_shadow         = GetValue('tweet_shadow');
    config.link_in_bg           = GetValue('link_in_bg');
    config.start_count.home     = GetValue('home_tweets_page');
    config.refresh.home         = GetValue('home_refresh_time');
    config.start_count.mentions = GetValue('mentions_tweets_page');
    config.refresh.mentions     = GetValue('mentions_refresh_time');
    config.start_count.messages = GetValue('messages_tweets_page');
    config.refresh.messages     = GetValue('messages_refresh_time');

    config.twitter_question     = $('#twitter_question').val();

    config = J2S(config);
    db.salva('config', config);
    Controller().ReLoadConfig();
    location.reload();
}
function init(){
    document.title = Traduz('configuration')+' - Chrowety';
    LoadConfig();
    document.charset = Controller().language.charset;
    Toggle($('#main'));
}
$(document).ready(init);
/*]]>*/
</script>
</head>
<body>
<div id="init" class="config">
    <div class="tit p16 oceania">
      <span class="titulo fl p16 oceania">
          <img src="icones/x32.png" class="icon"/>Chrowety
      </span>
      <span class="fl p16 oceania"><script>html(Traduz('configuration'))</script></span>
      <span class="popup_close2 fr" onclick="window.close();">X</span>
    </div>
    <br/>
    <div class="con">
        <fieldset class="section" active="false" id="main">
            <legend class="oceania" onclick="Toggle(this.parentNode);"><script>html(Traduz('main'))</script></legend>
            <div class="dn">
            <span class="stit"><script>html(Traduz('home'))</script>:</span>
            <label><script>html(Traduz('tweets_per_page'))</script>
              <select id="home_tweets_page">
                <option value="10">10</option>
                <option value="15">15</option>
                <option value="20">20</option>
                <option value="25">25</option>
                <option value="30">30</option>
              </select>
            </label>
                    
            <label><script>html(Traduz('refresh_time'))</script>
              <select id="home_refresh_time">
                <option value="3">3 <script>html(Traduz('minutes'))</script></option>
                <option value="5">5 <script>html(Traduz('minutes'))</script></option>
                <option value="8">8 <script>html(Traduz('minutes'))</script></option>
                <option value="10">10 <script>html(Traduz('minutes'))</script></option>
                <option value="15">15 <script>html(Traduz('minutes'))</script></option>
                <option value="20">20 <script>html(Traduz('minutes'))</script></option>
              </select>
            </label>


            <br /><br />
            <span class="stit"><script>html(Traduz('mentions'))</script>:</span>
            <label><script>html(Traduz('tweets_per_page'))</script>
              <select id="mentions_tweets_page">
                <option value="10">10</option>
                <option value="15">15</option>
                <option value="20">20</option>
                <option value="25">25</option>
                <option value="30">30</option>
              </select>
            </label>
                    
            <label><script>html(Traduz('refresh_time'))</script>
              <select id="mentions_refresh_time">
                <option value="3">3 <script>html(Traduz('minutes'))</script></option>
                <option value="5">5 <script>html(Traduz('minutes'))</script></option>
                <option value="8">8 <script>html(Traduz('minutes'))</script></option>
                <option value="10">10 <script>html(Traduz('minutes'))</script></option>
                <option value="15">15 <script>html(Traduz('minutes'))</script></option>
                <option value="20">20 <script>html(Traduz('minutes'))</script></option>
                <option value="30">30 <script>html(Traduz('minutes'))</script></option>
              </select>
            </label>


            <br /><br />
            <span class="stit"><script>html(Traduz('messages'))</script>:</span>
            <label><script>html(Traduz('tweets_per_page'))</script>
              <select id="messages_tweets_page">
                <option value="10">10</option>
                <option value="15">15</option>
                <option value="20">20</option>
                <option value="25">25</option>
                <option value="30">30</option>
              </select>
            </label>
                    
            <label><script>html(Traduz('refresh_time'))</script>
              <select id="messages_refresh_time">
                <option value="5">5 <script>html(Traduz('minutes'))</script></option>
                <option value="7">7 <script>html(Traduz('minutes'))</script></option>
                <option value="10">10 <script>html(Traduz('minutes'))</script></option>
                <option value="15">15 <script>html(Traduz('minutes'))</script></option>
                <option value="20">20 <script>html(Traduz('minutes'))</script></option>
                <option value="30">30 <script>html(Traduz('minutes'))</script></option>
                <option value="40">40 <script>html(Traduz('minutes'))</script></option>
              </select>
            </label>
            <br /><br />
            <label><script>html(Traduz('url_shortener'))</script>
              <select id="url_shortener">
                <option value="3.ly">3.ly</option>
                <option value="migre.me">migre.me</option>
                <option value="goo.gl">goo.gl</option>
                <option value="bit.ly">bit.ly</option>
                <option value="j.mp">j.mp</option>
                <option value="is.gd">is.gd</option>
               <!-- <option value="tr.im">tr.im</option> -->
              </select>
            </label>
            <br /><br />
            <label><script>html(Traduz('alerts'))</script>
              <select id="alerts">
                <option value="true"><script>html(Traduz('yes'))</script></option>
                <option value="false"><script>html(Traduz('no'))</script></option>
              </select>
            </label>
            <br /><br />
            <label><script>html(Traduz('max_tweets_per_alerts'))</script>
              <select id="alerts_max">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
              </select>
            </label>

            <br /><br />
            <label><script>html(Traduz('open_links_in_background'))</script>
              <select id="link_in_bg">
                <option value="true"><script>html(Traduz('yes'))</script></option>
                <option value="false"><script>html(Traduz('no'))</script></option>
              </select>
            </label>    
<!--
            <br /><br />
            <span class="stit"><script>html(Traduz('favorites'))</script>:</span>
            <label>Tweets per page
              <select id="home_tweets_page">
                <option value="10">10</option>
                <option value="15">15</option>
                <option value="20">20</option>
                <option value="25">25</option>
                <option value="30">30</option>
              </select>
            </label>
                    
            <label>Refresh time
              <select id="home_refresh_time">
                <option value="5">5 Minutes</option>
                <option value="7">7 Minutes</option>
                <option value="10">10 Minutes</option>
                <option value="15">15 Minutes</option>
                <option value="20">20 Minutes</option>
              </select>
            </label>

            <label>Show Retweets
                <input type="checkbox"/>
            </label>
            <br />
            <label>Show Retweets
                <input type="radio"/>
            </label>
-->
            <br /><br />
            </div>
        </fieldset>

        <fieldset class="section" active="false" id="interface">
            <legend class="oceania" onclick="Toggle(this.parentNode);"><script>html(Traduz('interface'))</script></legend>
            <div class="dn">
            <label><script>html(Traduz('language'))</script>
              <select id="language">
                <option value="en">English</option>
                <option value="pt-br">Português (Brasil)</option>
                <option value="es">Spanish</option>
                <option value="de">Deutsch</option>
                <option value="nl">Dutch</option>
                <!--<option value="cn">Chinese</option>-->
              </select>
            </label> (<script>html(Traduz('restart_required'))</script>)
            <br /><br />
            <label><script>html(Traduz('tweet_font_size'))</script>
              <select id="tweet_font_size">
                <option value="5pt">5pt</option>
                <option value="6pt">6pt</option>
                <option value="7pt">7pt</option>
                <option value="8pt">8pt</option>
                <option value="9pt">9pt</option>
                <option value="10pt">10pt</option>
                <option value="11pt">11pt</option>
                <option value="12pt">12pt</option>
                <option value="13pt">13pt</option>
                <option value="14pt">14pt</option>
                <option value="15pt">15pt</option>
                <option value="16pt">16pt</option>
                <option value="17pt">17pt</option>
                <option value="18pt">18pt</option>
                <option value="19pt">19pt</option>
              </select>
            </label>
            <br /><br />
            <label><script>html(Traduz('text_shadow'))</script>
              <select id="tweet_shadow">
                <option value="1px 1px 1px #ccc"><script>html(Traduz('yes'))</script></option>
                <option value="false"><script>html(Traduz('no'))</script></option>
              </select>
            </label>

            <br /><br />
            <label><script>html(Traduz('twitter_question'))</script>
              <input id="twitter_question" type="text" value="" size="24" />
            </label> <a title="" class="p8" onclick="ResetSlogan()"><script>html(Traduz('reset2'))</script></a>


            <br /><br />
           </div>
        </fieldset>

        <fieldset class="section" active="false" id="other">
            <legend class="oceania" onclick="Toggle(this.parentNode);"><script>html(Traduz('other'))</script></legend>
            <div class="dn">
            <p><script>html(Traduz('twitter_limits_api'))</script></p>
            <br />
            <label><script>html(Traduz('remaining_requests'))</script>  <span id="api_limit"><script>html(db.pega('api_limit'))</script>/150</span></label>
            <br /><br />
            <label><script>html(Traduz('requests_per_hour'))</script>:
              <span id="api_time">
              <script>html(Controller().CalculaApiRequests().numero)</script>
              (<script>html(Controller().CalculaApiRequests().porcento)</script>%)
              </span>
            </label>
            <br /><br />
            <label><script>html(Traduz('reset_time'))</script>  <span id="api_time"><script>html(Controller().ApiDate(db.pega('api_reset_time')))</script></span></label>
            <br /><br />
            <span class="p8">*<script>html(Traduz('how_to_restart'))</script></span>
            </div>
        </fieldset>

        <br /><br />
        <button class="oceania" onclick="SaveConfig()"><script>html(Traduz('save'))</script></button>
        <br /><br />
        <a title="" class="p8" onclick="Reset()"><script>html(Traduz('reset'))</script></a>
    </div>
    <br />
</div>
<br />
<div class="rodape reflect clip">
    <span class="version">Chrowety <script>html(db.pega('version'))</script></span>
    <br />
    <span class="autor">Pedro Junior | v.ju.ni.or.v@gmail.com</span>
</div>
</body>
</html>

